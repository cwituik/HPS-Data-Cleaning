library(tidyverse)
library(tm)
getwd()

#Import Data
data <- readxl::read_xlsx("HPS Use of Force.xlsx", sheet = 2)

#remove numbers and characters from perceived race
data <- data%>%
  mutate(subject1_perceived_race=trimws(str_remove(subject1_perceived_race, "(\\s+[A-Za-z]+)?[0-9-]+")))%>%
  mutate(subject2_perceived_race=trimws(str_remove(subject2_perceived_race, "(\\s+[A-Za-z]+)?[0-9-]+")))%>%
  mutate(subject3_perceived_race=trimws(str_remove(subject3_perceived_race, "(\\s+[A-Za-z]+)?[0-9-]+")))


#Clean Perceived Race
table(data$subject1_perceived_race)
table(data$subject2_perceived_race)
table(data$subject2_perceived_race)

data$subject1_perceived_race <- recode(data$subject1_perceived_race, "E/S/E"="E/S/E Asian")
data$subject1_perceived_race <- recode(data$subject1_perceived_race, "Middle"="Middle Eastern")
data$subject1_perceived_race <- recode(data$subject1_perceived_race, "S/Asian"="South Asian")
data$subject1_perceived_race <- recode(data$subject1_perceived_race, "South"="South Asian")

#Clean Generated By
table(data$generated_by)
data$generated_by <- recode(data$generated_by, "Gangs and Weapons\r\n Unit"="Gangs and Weapons")
data$generated_by <- recode(data$generated_by, "Gangs and\r\n Weapons"="Gangs and Weapons")
data$generated_by <- recode(data$generated_by, "Intelligence\r\n Unit"="Intelligence")
data$generated_by <- recode(data$generated_by, "Major\r\n Crime"="Major Crime")
data$generated_by <- recode(data$generated_by, "Uniform\r\n Patrol"="Uniform Patrol")
data$generated_by <- recode(data$generated_by, "Uniform"="Uniform Patrol")
data$generated_by <- recode(data$generated_by, "Officer"="Uniform Patrol")
data$generated_by <- recode(data$generated_by, "Vice and Drug Unit"="Vice and Drugs")
data$generated_by <- recode(data$generated_by, "Vice and\r\n Drugs"="Vice and Drugs")
data$generated_by <- recode(data$generated_by, "Vice and\r\n Drug Unit"="Vice and Drugs")
data$generated_by <- recode(data$generated_by, "Hamilton\r\n Fire"="Hamilton Fire")
data$generated_by <- recode(data$generated_by, "Fire"="Hamilton Fire")
data$generated_by <- recode(data$generated_by, "Outside\r\n Agency"="Outside Agency")
data$generated_by <- recode(data$generated_by, "Outside\r\n agency"="Outside Agency")
data$generated_by <- recode(data$generated_by, "CID"="CIB")
table(data$generated_by)

#Clean Occurrence Type
table(data$occurrence_type)
data$occurrence_type <- recode(data$occurrence_type, "Barricaded\r\n Person"="Barricaded Person")
data$occurrence_type <- recode(data$occurrence_type, "CDSA\r\n Offence"="CDSA")
data$occurrence_type <- recode(data$occurrence_type, "CDSA\r\n Search\r\n Warrant"="CDSA")
data$occurrence_type <- recode(data$occurrence_type, "CDSA\r\n Warrant"="CDSA")
data$occurrence_type <- recode(data$occurrence_type, "CDSA -\r\n Search\r\n warrant"="CDSA")
data$occurrence_type <- recode(data$occurrence_type, "CDSA search\r\n warrant"="CDSA")
data$occurrence_type <- recode(data$occurrence_type, "CDSA Search\r\n warrant"="CDSA")
data$occurrence_type <- recode(data$occurrence_type, "CDSA Search\r\n Warrant"="CDSA")
data$occurrence_type <- recode(data$occurrence_type, "CDSA search warrant"="CDSA")
data$occurrence_type <- recode(data$occurrence_type, "CDSA Search warrant"="CDSA")
data$occurrence_type <- recode(data$occurrence_type, "CDSA Search Warrant"="CDSA")
data$occurrence_type <- recode(data$occurrence_type, "Driving\r\n Complaint"="Driving Complaint")
data$occurrence_type <- recode(data$occurrence_type, "Fail to\r\n remain"="Fail to Remain")
data$occurrence_type <- recode(data$occurrence_type, "Fail to\r\n Remain"="Fail to Remain")
data$occurrence_type <- recode(data$occurrence_type, "Fire call"="Fire Assist")
data$occurrence_type <- recode(data$occurrence_type, "Fire Call"="Fire Assist")
data$occurrence_type <- recode(data$occurrence_type, "Firearm\r\n Offences"="Firearm Investigation")
data$occurrence_type <- recode(data$occurrence_type, "Firearms investigation"="Firearm Investigation")
data$occurrence_type <- recode(data$occurrence_type, "Found\r\n Person"="Found Person")
data$occurrence_type <- recode(data$occurrence_type, "Neighbour\r\n Trouble"="Neighbour Trouble")
data$occurrence_type <- recode(data$occurrence_type, "Person in\r\n crisis"="Person in Crisis")
data$occurrence_type <- recode(data$occurrence_type, "Person in\r\n Crisis"="Person in Crisis")
data$occurrence_type <- recode(data$occurrence_type, "Person In\r\n Crisis"="Person in Crisis")
data$occurrence_type <- recode(data$occurrence_type, "Person in crisis"="Person in Crisis")
data$occurrence_type <- recode(data$occurrence_type, "Person In Crisis"="Person in Crisis")
data$occurrence_type <- recode(data$occurrence_type, "Search\r\n warrant"="Search Warrant")
data$occurrence_type <- recode(data$occurrence_type, "Search\r\n Warrant"="Search Warrant")
data$occurrence_type <- recode(data$occurrence_type, "Search warrant"="Search Warrant")
data$occurrence_type <- recode(data$occurrence_type, "Suspicious\r\n Person"="Suspicious Person")
data$occurrence_type <- recode(data$occurrence_type, "Suspicious person"="Suspicious Person")
data$occurrence_type <- recode(data$occurrence_type, "Suspicious\r\n Vehicle"="Suspicious Vehicle")
data$occurrence_type <- recode(data$occurrence_type, "Suspicious vehicle"="Suspicious Vehicle")
data$occurrence_type <- recode(data$occurrence_type, "Traffic"="Traffic Stop")
data$occurrence_type <- recode(data$occurrence_type, "Unwanted\r\n Guest"="Unwanted Guest")
data$occurrence_type <- recode(data$occurrence_type, "Wanted\r\n Person"="Wanted Party")
data$occurrence_type <- recode(data$occurrence_type, "Wanted\r\n Party"="Wanted Party")
data$occurrence_type <- recode(data$occurrence_type, "Weapons call"="Weapons Call")
data$occurrence_type <- recode(data$occurrence_type, "Weapon Call"="Weapons Call")
data$occurrence_type <- recode(data$occurrence_type, "Weapon in\r\n progress"="Weapons Call")
data$occurrence_type <- recode(data$occurrence_type, "Weapon in progress"="Weapons Call")
data$occurrence_type <- recode(data$occurrence_type, "Weapons"="Weapons Call")
data$occurrence_type <- recode(data$occurrence_type, "Weapons\r\n call"="Weapons Call")
data$occurrence_type <- recode(data$occurrence_type, "Weapons\r\n Call"="Weapons Call")
data$occurrence_type <- recode(data$occurrence_type, "Weapons Call -\r\n Barricaded"="Weapons Call")
data$occurrence_type <- recode(data$occurrence_type, "Weapons Calls"="Weapons Call")
data$occurrence_type <- recode(data$occurrence_type, "Weapons in\r\n progress"="Weapons Call")
data$occurrence_type <- recode(data$occurrence_type, "Weapons in progress"="Weapons Call")

#clean weapon carried subject
table(data$weapon_carried_subject)
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Access to\r\n firearms"="Access to Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Access to\r\n Firearms"="Access to Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Access to firearm"="Access to Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Access to Firearms"="Access to Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Access to firearms"="Access to Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Access to weapons"="Access to Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm\r\n concealed"="Firearm Concealed")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm\r\n Concealed"="Firearm Concealed")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm concealed"="Firearm Concealed")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm -\r\n Concealed"="Firearm Concealed")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm - at hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm - at\r\n hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm - At\r\n hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm - at hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm - in\r\n hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm - In\r\n hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm - in hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm  In hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm at hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm in hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm - at hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms - at hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms - Carried"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm - At Hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm - In hand"="Firearm - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm\r\n mentioned"="Firearm - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm -\r\n mentioned"="Firearm - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm -\r\n Mentioned"="Firearm - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm mentioned"="Firearm - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm Mentioned"="Firearm - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms\r\n mentioned"="Firearm - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "firearms mentioned"="Firearm - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms\r\n mentioned"="Firearm - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms mentioned"="Firearm - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Mention of Firearm"="Firearm - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Mention of\r\n firearm"="Firearm - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms mentioned"="Firearm - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm\r\n discharged at Police"="Firearm - Discharged at Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm discharged"="Firearm - Discharged")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm discharged at Police"="Firearm - Discharged at Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm shot at police"="Firearm - Discharged at Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm used"="Firearm - Discharged")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm Used"="Firearm - Discharged")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm used\r\n and mentioned"="Firearm - Discharged")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm used"="Firearm - Discharged")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm\r\n pointed at\r\n Police"="Firearm - Pointed at Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm\r\n pointed at\r\n Police"="Firearm - Pointed at Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm Pointed at\r\n Police"="Firearm - Pointed at Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm Concealed"="Firearm - Concealed")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms - Carried"="Firearm - Carried")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm in\r\n house"="Firearm - In Vehicle/House")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm in vehicle"="Firearm - In Vehicle/House")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms - In\r\n vehicle"="Firearm - In Vehicle/House")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms - in residence"="Firearm - In Vehicle/House")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms - In vehicle"="Firearm - In Vehicle/House")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms in\r\n vehicle"="Firearm - In Vehicle/House")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms in residence"="Firearm - In Vehicle/House")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms - In vehicle"="Firearm - In Vehicle/House")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm in residence"="Firearm - In Vehicle/House")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Active resistant"="Active Resistant")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Assaultive,\r\n active resistant"="Assaultive, Active Resistant")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Edge weapon -\r\n in hand"="Edged weapon in Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Edge Weapon -\r\n in hand"="Edged weapon in Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Edged Weapon\r\n - at hand"="Edged weapon in Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Edged weapon in hand"="Edged weapon in Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Edged weapon in Hand"="Edged weapon in Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "History of\r\n Weapons"="History of Weapons or Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "History of\r\n firearms"="History of Weapons or Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "History of firearms"="History of Weapons or Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "History/Access\r\n to firearms"="History of Weapons or Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "History of Firearms"="History of Weapons or Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "History of firearm"="History of Weapons or Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "History of\r\n Firearms"="History of Weapons or Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm history"="History of Weapons or Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearms history"="History of Weapons or Firearms")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife - at hand"="Knife - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife - At hand"="Knife - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife - in hand"="Knife - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife - In hand"="Knife - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife at hand"="Knife - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife in hand"="Knife - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Firearm mentioned\r\n knife - at hand"="Firearm -Mentioned and Knife - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife/Edged Weapons - in\r\n hand"="Knife - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife - In hand"="Knife - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife/Edged Weapons - in\r\n hand"="Knife - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife -\r\n Mentioned"="Knife - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife\r\n mentioned"="Knife - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Mention of\r\n weapon (knife)"="Knife - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife -\r\n Concealed"="Knife - Concealed")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife concealed"="Knife - Concealed")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapon - in\r\n hand"="Weapon - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapon - in hand"="Weapon - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapon - In hand"="Weapon - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapon at\r\n hand"="Weapon - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapon at hand"="Weapon - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapon in\r\n hand"="Weapon - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapon in hand"="Weapon - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapons at\r\n hand"="Weapon - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapons at hand"="Weapon - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapons in\r\n hand"="Weapon - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapons of opportunity at\r\n hand"="Weapon - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapons of opportunity in\r\n hands"="Weapon - At Hand")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife -\r\n attacking officers"="Attacking Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife -\r\n attacking Police"="Attacking Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife in hand\r\n Charging Police"="Attacking Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife in hand -\r\n lunged at officers"="Attacking Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife in hand -\r\n moving\r\n towards Police"="Knife in Hand Moving Towards Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife in hand lunged at\r\n officers"="Attacking Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Throwing Items at officers"="Throwing Items at Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Edged Weapon\r\n - in hand charged at\r\n Police"="Attacking Police")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Edge weapon concealed, Assaultive"="Edge Weapon Concealed, Assaultive")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Passive\r\n resistant non\r\n compliant"="Resistant/Non Compliant")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Passive\r\n resistant non compliance"="Resistant/Non Compliant")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Passive resistant non\r\n compliant"="Resistant/Non Compliant")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Resistant"="Resistant/Non Compliant")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Resistant\r\n information of knife concealed"="Resistant/Non Compliant")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Knife\r\n concealed. Active resistant"="Knife Concealed, Resistant/Non Compliant")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Non compliant"="Resistant/Non Compliant")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapons Mentioned"="Weapon - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapons\r\n mentioned"="Weapon - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapon\r\n mentioned"="Weapon - Mentioned")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapon\r\n concealed"="Weapon - Concealed")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapon concealed"="Weapon - Concealed")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapons\r\n Concealed"="Weapon - Concealed")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapons concealed"="Weapon - Concealed")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapons in\r\n house"="Weapon - In Vehicle/House")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Weapons in vehicle"="Weapon - In Vehicle/House")
data$weapon_carried_subject <- recode(data$weapon_carried_subject, "Attempting self\r\n harm"="Attempting Self Harm")

#Clean officer response
table(data$officer_response)
data$officer_response <- recode(data$officer_response, "ACTION - Handgun drawn"="ACTION - Handgun Drawn")
data$officer_response <- recode(data$officer_response, "ACTION - Handgun Drawn"="ACTION - Handgun Drawn")
data$officer_response <- recode(data$officer_response, "ERU - EH soft, EH hard,\r\n CEW"="EH soft, EH hard, CEW")
data$officer_response <- recode(data$officer_response, "ERU - Firearm point"="ERU - Firearm Point")
data$officer_response <- recode(data$officer_response, "ERU - Point Firearm"="ERU - Firearm Point")
data$officer_response <- recode(data$officer_response, "ERU - Point firearm"="ERU - Firearm Point")
data$officer_response <- recode(data$officer_response, "ERU- Firearm Point"="ERU - Firearm Point")
data$officer_response <- recode(data$officer_response, "Gangs and Weapons -\r\n Firearm Point"="Gangs and Weapons - Firearm Point")
data$officer_response <- recode(data$officer_response, "Intelligence - Firearm\r\n Point"="Intelligence - Firearm Point")
data$officer_response <- recode(data$officer_response, "Intelligence - Firearm Point"="Intelligence - Firearm Point")
data$officer_response <- recode(data$officer_response, "K9 - K9 Bite"="K9 - K9 Bite")
data$officer_response <- recode(data$officer_response, "K9 - K9"="K9 - K9 Bite")
data$officer_response <- recode(data$officer_response, "K9- K9 bite"="K9 - K9 Bite")
data$officer_response <- recode(data$officer_response, "MCRRT - EH hard, EH Soft,\r\n CEW"="MCRRT - EH hard, EH soft, CEW")
data$officer_response <- recode(data$officer_response, "MCRRT - Firearm point,\r\n CEW"="MCRRT - Firearm Point, CEW")
data$officer_response <- recode(data$officer_response, "Uniform - Cew"="Uniform Patrol - CEW")
data$officer_response <- recode(data$officer_response, "Uniform - CEW"="Uniform Patrol - CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol- CEW"="Uniform Patrol - CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - CEW"="Uniform Patrol - CEW")
data$officer_response <- recode(data$officer_response, "Uniform patrol - CEW"="Uniform Patrol - CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Cew"="Uniform Patrol - CEW")
data$officer_response <- recode(data$officer_response, "Uniform patrol - CEW"="Uniform Patrol - CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - CEW,\r\n Carbine Pistol"="Uniform Patrol - CEW, Carbine Pistol")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - CEW, EH\r\n Hard, EH Soft"="Uniform Patrol - CEW, EH Hard, EH Soft")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - E/H Hard,\r\n E/H Soft, CEW"="Uniform Patrol - CEW, EH Hard, EH Soft")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - EH Hard,\r\n CEW"="Uniform Patrol - EH Hard, CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - CEW, EH Hard"="Uniform Patrol - EH Hard, CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - EH soft,\r\n CEW"="Uniform Patrol - EH soft, CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - EH Soft,\r\n CEW"="Uniform Patrol - EH soft, CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - CEW, EH Soft"="Uniform Patrol - EH soft, CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - CEW, EH soft"="Uniform Patrol - EH soft, CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - EHS, EHH,\r\n CEW"="Uniform Patrol - EHS, EHH, CEW")
data$officer_response <- recode(data$officer_response, "Uniform - Firearm point"="Uniform Patrol - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform Patrol- Firearm Point"="Uniform Patrol - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform Patrol- Firearm\r\n Point"="Uniform Patrol - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Firearm point"="Uniform Patrol - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform patrol - Firearm Point"="Uniform Patrol - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform Patrol -Firearm Point"="Uniform Patrol - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Firearm\r\n point"="Uniform Patrol - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Firearms Point"="Uniform Patrol - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - firearm\r\n point"="Uniform Patrol - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - firearm\r\n point"="Uniform Patrol - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Firearm\r\n Point"="Uniform Patrol - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Firearm\r\n point, EH Soft, CEW"="Uniform Patrol - Firearm Point, EH Soft, CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Firearm\r\n discharge, EH Hard"="Uniform Patrol - Firearm Discharge, EH Hard")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Firearm\r\n Point"="Uniform Patrol - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform Patrol -\r\n I/Weapon hard"="Uniform Patrol - Weapon Hard")
data$officer_response <- recode(data$officer_response, "Uniform - Animal Dispatch"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Animal dispatch"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Animal Dispatch"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Animal\r\n dispatch"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Animal\r\n Dispatch"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Animal dispatch"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Dispatch\r\n animal"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Animal\r\n dispatch"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Animal\r\n dispatch"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Animal Dispatch"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Dispatch animal"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Dispatch\r\n animal"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Dispatch Animal"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Dispatch\r\n Animal"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Animal\r\n Dispatch"="Uniform Patrol - Animal Dispatch")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - CEW,\r\n empty hands soft"="Uniform Patrol - CEW, empty hands soft")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - CEW,\r\n Firearm Point"="Uniform Patrol - CEW, Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Handgun\r\n Drawn"="Uniform Patrol - Handgun Drawn")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Handgun\r\n drawn"="Uniform Patrol - Handgun Drawn")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - handgun\r\n drawn"="Uniform Patrol - Handgun Drawn")
data$officer_response <- recode(data$officer_response, "Uniform patrol - Handgun\r\n Drawn"="Uniform Patrol - Handgun Drawn")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Handgun Drawn"="Uniform Patrol - Handgun Drawn")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Handgun drawn"="Uniform Patrol - Handgun Drawn")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - handgun drawn"="Uniform Patrol - Handgun Drawn")
data$officer_response <- recode(data$officer_response, "Youth Office - Firearm\r\n Point"="Youth Office - Firearm Point")
data$officer_response <- recode(data$officer_response, "Youth - Firearm point"="Youth Office - Firearm Point")
data$officer_response <- recode(data$officer_response, "Youth - EH soft, Firearm\r\n Point"="Youth Office - EH Soft, Firearm Point")
data$officer_response <- recode(data$officer_response, "Youth - EH Hard, CEW"="Youth Office - EH Hard, CEW")
data$officer_response <- recode(data$officer_response, "Vice and Drugs - Firearm\r\n Point"="Vice and Drugs - Firearm Point")
data$officer_response <- recode(data$officer_response, "Vice and Drugs - Firearm\r\n point"="Vice and Drugs - Firearm Point")
data$officer_response <- recode(data$officer_response, "Uniform patrol -EH Soft,\r\n EH hard"="Uniform patrol - EH Soft, EH hard")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Firearm point, CEW"="Uniform Patrol - Firearm Point, CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Firearm\r\n Point, CEW"="Uniform Patrol - Firearm Point, CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Firearm\r\n Point, EH Hard"="Uniform Patrol - Firearm Point, EH Hard")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Firearm Point, EH Hard"="Uniform Patrol - Firearm Point, EH Hard")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Firearm\r\n point, EH Soft"="Uniform Patrol - Firearm Point, EH Soft")
data$officer_response <- recode(data$officer_response, "Uniform Patrol -\r\n I/Weapon hard"="Uniform Patrol - I/Weapon hard")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Hand gun\r\n Drawn, CEW"="Uniform Patrol - Hand gun Drawn, CEW")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Empty\r\n hands hard, E/H Soft"="Uniform Patrol - Empty Hands Hard, EH Soft")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Empty\r\n Hands Hard"="Uniform Patrol - Empty Hands Hard")
data$officer_response <- recode(data$officer_response, "Uniform Patrol - Empty\r\n hand soft"="Uniform Patrol - Empty Hands Soft")

#clean location
table(data$location)
data$location <- recode(data$location, "Other\r\n Jurisdiction"="Outside jurisdiction")
data$location <- recode(data$location, "Out of\r\n jurisdiction"="Outside jurisdiction")
data$location <- recode(data$location, "Outside\r\n jurisdiction"="Outside jurisdiction")
data$location <- recode(data$location, "Out of Jurisdiction"="Outside jurisdiction")



#wide data exclude animals

wide_no_animal <- data%>%
  filter(weapon_carried_subject!="Coyote", weapon_carried_subject!="Deer", weapon_carried_subject!="Dog attacked officers", weapon_carried_subject!="Racoon" )

#long data excluding animals
data_long <- data%>%
  filter(weapon_carried_subject!="Coyote", weapon_carried_subject!="Deer", weapon_carried_subject!="Dog attacked officers", weapon_carried_subject!="Racoon" )

table(data_long$weapon_carried_subject)

library(tidyr)  
data_long <- data_long%>%
pivot_longer(cols=starts_with('sub'), names_to = "race", values_to = "perceived_race_individual")%>%
  filter(!is.na(perceived_race_individual))%>%
  ungroup()%>%
  select(-race)



#Write Data
library(openxlsx)
write.xlsx(data, "HPS Clean Data.xlsx")
write.xlsx(wide_no_animal, "HPS Clean Data No Animals.xlsx")
write.xlsx(data_long, "HPS Clean Data No Animals Long.xlsx")
